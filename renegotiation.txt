Project Phase 2 – Security Analysis




As a Boilermaker pursuing academic excellence, we pledge to be honest and true in all that we do. Accountable together – We are Purdue.

(On group submissions, have each team member type their name).



Type or sign your names: Heh Kle, Erik Perez

Write today’s date: 11/16/2025




























Assignment

This document provides a template for your system's security analysis. You are welcome to add content beyond what is listed; the template is designed to help ensure you cover all crucial components.

The terms used in this section are defined here.

Security requirements.
Here, list the security requirements of your system, aligned with the six security properties defined by the STRIDE article. These requirements may be unique to your system, depending on which features you implemented. It is possible that you will not have a requirement associated with every security property.

Confidentiality
[All systems]: Observers along the network cannot directly observe client-server interactions. 
…

Integrity
…

Availability
…

Authentication
Project Phase 2 – Security Analysis

As a Boilermaker pursuing academic excellence, we pledge to be honest and true in all that we do. Accountable together – We are Purdue.

Type or sign your names: Heh Kle, Erik Perez
Write today’s date: 11/16/2025

============================================================
1. Security Requirements (Mapped to STRIDE Properties)
============================================================
System Overview: The ModelRegistry system consists of a browser-based frontend (localhost origins), a FastAPI backend (`main.py`), artifact ingestion logic (`ArtifactManager`), storage abstraction (`StorageManager`), AWS S3 bucket for artifact binary/JSON storage, AWS DynamoDB table for metadata, and external third‑party artifact source URLs fetched over HTTP. A future authentication token (`UPLOAD_TOKEN`) is present but currently unenforced. Logging uses Python standard logging.

Confidentiality (Information Disclosure)
- C1: All client↔backend communications must occur over HTTPS in deployment to prevent passive network eavesdropping.
- C2: S3 objects must not be publicly listable or world-readable; only backend IAM role may access bucket objects.
- C3: Metadata returned to clients must exclude internal scoring heuristics not needed by end users (principle of minimal disclosure).
- C4: Secrets (AWS credentials, tokens) must only reside in environment variables or secret manager, never in source repo.

Integrity (Tampering)
- I1: Artifact metadata in DynamoDB must not be modified by unauthenticated or unauthorized actors.
- I2: S3 artifact contents must be write‑once except via authenticated update endpoint enforcing optimistic concurrency (prevent silent overwrites).
- I3: Inputs (URLs, filenames, artifact types) must be validated/sanitized to prevent injection into logs or storage expressions.

Availability (Denial of Service)
- A1: System must resist volumetric request floods with rate limiting (per IP + global) and graceful degradation.
- A2: Upload size limits and timeout controls must prevent resource exhaustion (memory / threads) on large or malicious URLs.
- A3: Reset operations must be restricted; unrestricted resets would create an availability outage.

Authentication (Spoofing)
- AU1: Mutating endpoints (create/update/delete/reset) must require a validated token or future user identity (JWT/OIDC) instead of the current `verify_token` stub that always returns True.

Authorization (Elevation of Privilege)
- AZ1: Separate roles: reader vs maintainer vs admin (reset) enforced via token scopes / claims.
- AZ2: Backend IAM role must have least privilege (only required S3 bucket, only required DynamoDB table).

Nonrepudiation (Repudiation)
- NR1: Mutations must be logged with timestamp, request ID, caller identity/token hash, artifact_id, and action.
- NR2: Logs must be immutable (write‑once retention) and shipped to a centralized service (e.g., CloudWatch + retention policy) to prevent tampering post‑incident.

============================================================
2. System Model (Textual DFD Description)
============================================================
Actors / External Entities: End User Browser; External Artifact Source (third‑party URL); AWS Infrastructure (S3, DynamoDB). Process: FastAPI Application. Data Stores: S3 Bucket (Artifact Objects); DynamoDB Table (Metadata). Supporting Modules: `ArtifactManager` (parses external source URL and computes scores); `StorageManager` (orchestrates DB + S3); Logging subsystem. Data Flows: (1) User → FastAPI (HTTP requests); (2) FastAPI → Artifact Source (HTTP GET to fetch content/metadata); (3) FastAPI ↔ S3 (upload/update/delete); (4) FastAPI ↔ DynamoDB (CRUD metadata); (5) User ← FastAPI (responses). Trust Boundaries: TB1 (Public Internet between Browser and API); TB2 (Backend to External Artifact URLs); TB3 (Backend to AWS managed services); TB4 (Administrative endpoints invoking destructive operations like /reset).

============================================================
3. Trust Boundaries and Threats
============================================================
Trust Boundary #1 (TB1)
- Untrusted party: External users / clients over the public Internet.
- Rationale: Requests originate outside organizational control; must assume hostile network and arbitrary clients.
- Potential attack: MITM intercepting unencrypted traffic, or scripted flooding of artifact mutations without auth causing data corruption and DoS.

Trust Boundary #2 (TB2)
- Untrusted party: Third‑party artifact source servers; content fetched is unvalidated and may be malicious.
- Rationale: System ingests remote data; integrity and safety of external URLs cannot be guaranteed.
- Potential attack: Malicious file causing excessive parsing time (ReDoS), or exploiting parser logic to craft oversized payload causing resource exhaustion.

Trust Boundary #3 (TB3)
- Untrusted party: AWS infrastructure provider (shared responsibility) and potential misconfiguration exposures.
- Rationale: Reliance on cloud services with configuration surfaces (IAM, bucket ACLs) that if mis-set expose data.
- Potential attack: Publicly accessible S3 objects exfiltrated or IAM role escalation leading to mass metadata tampering.

Trust Boundary #4 (TB4)
- Untrusted party: Anyone invoking /reset without proper authorization under current code.
- Rationale: Endpoint performs destructive cross‑store operation; presently no access control.
- Potential attack: Unauthorized reset wiping all artifacts and metadata, leading to availability loss and potential repudiation gap.

============================================================
4. AI-Assisted Threat Modeling & Feedback Summary
============================================================
Two sub-groups queried an LLM with (a) component list, (b) trust boundaries, (c) planned AWS deployment. Prompts requested: secure S3 bucket configuration (block public ACLs, enforce SSE-S3 or SSE-KMS, enable versioning), DynamoDB best practices (conditional writes, IAM least privilege, encryption at rest), FastAPI hardening (rate limiting, CORS restriction to known origins, structured logging with request IDs), and ingestion safety (timeout + size limits). Both groups converged on: need real authentication, least privilege IAM, and input validation. Differences: Group A emphasized DoS (rate limiting, WAF); Group B emphasized nonrepudiation (audit log structure). We adopted a combined plan: implement auth token validation, restrict CORS, add structured audit logging, enforce S3 bucket public access block, add DynamoDB conditional update, and integrate request size/time limits. Lower‑impact suggestions (e.g., full anomaly detection ML) deferred.

============================================================
5. STRIDE Threats, Mitigations, Decisions
============================================================
Format: Threat → Possible Mitigations → Decision → Implementation / Justification.

Spoofing
S1: Unauthenticated callers impersonate maintainers (verify_token always True).
- Mitigations: Implement real token verification (HMAC or JWT), rotate secrets, enforce HTTPS.
- Decision: Should Fix → Implement JWT validation middleware replacing stub; store signing key in secret manager.
S2: Artifact ID guessing to retrieve metadata.
- Mitigations: Use UUIDv4 artifact IDs; deny enumeration via rate limiting; 404 on unknown IDs without timing side channels.
- Decision: Should Fix → Switch to cryptographically random IDs (already likely but confirm entropy).
S3: IAM role compromise (AWS key leakage).
- Mitigations: Use instance/profile roles, no long-lived keys in repo; enable CloudTrail alerting.
- Decision: Should Fix → Remove any static credentials; verify only role assumed.

Tampering
T1: Overwrite artifact content silently via update without concurrency control.
- Mitigations: Conditional writes using DynamoDB `updated_at` check; versioning in S3; ETag comparison.
- Decision: Should Fix → Add DynamoDB conditional expression on expected `updated_at`.
T2: Manipulated URL causing injection into logs.
- Mitigations: Sanitize/escape user-controlled fields before logging; structured logging avoiding string concatenation.
- Decision: Should Fix → Replace f-string log of user input with structured dict.
T3: Malicious artifact modifying scores (ArtifactManager logic unvalidated).
- Mitigations: Strict schema validation and recomputation server-side; never trust client-provided scores.
- Decision: Should Fix → Enforce Pydantic model for artifact internal schema before persistence.

Repudiation
R1: Actor deletes artifact with no identity trail.
- Mitigations: Append-only audit log (action, artifact_id, token_id hash, timestamp, IP); log shipping.
- Decision: Should Fix → Implement middleware assigning request ID; log all mutations.
R2: Reset invoked; later denial of responsibility.
- Mitigations: Require admin scope; multi-factor or signed request; separate admin endpoint path.
- Decision: Should Fix → Require admin token scope + audit event.
R3: Lack of integrity on logs (local tampering).
- Mitigations: Remote log aggregation; write-once retention; periodic checksum.
- Decision: Won’t Fix (Phase scope) → Accept low risk due to development environment; plan future centralized logging.

Information Disclosure
ID1: Open CORS `allow_origins=["*"]` enables any site to read responses via JS.
- Mitigations: Restrict origins to controlled domains; enforce HTTPS.
- Decision: Should Fix → Replace wildcard with explicit list from config.
ID2: Public S3 objects accessible externally.
- Mitigations: Block Public Access; enforce bucket policy denying non‑IAM principal; enable encryption at rest.
- Decision: Should Fix → Apply AWS Public Access Block + SSE-S3.
ID3: Detailed exception traces returned via HTTP 400.
- Mitigations: Return generic error codes; capture full trace only in logs.
- Decision: Should Fix → Wrap exceptions mapping to sanitized message.
ID4: Potential keyloggers on client machine.
- Mitigations: Endpoint hardening cannot solve local compromise.
- Decision: Won’t Fix → Out of scope (endpoint security not client OS hygiene).

Denial of Service
DoS1: Flood of artifact create/update requests.
- Mitigations: Rate limiting per IP; exponential backoff; WAF or API Gateway throttling.
- Decision: Should Fix → Implement middleware rate limiter (token bucket) + deploy behind throttling gateway.
DoS2: Large remote URL causing memory exhaustion.
- Mitigations: Enforce max content length & stream with size cap; 10s timeout already exists (confirm); restrict MIME types.
- Decision: Should Fix → Add size validation and abort if > configured MB.
DoS3: ReDoS via pathological regex inside artifact parsing (if regex used).
- Mitigations: Audit regex patterns; precompile safe patterns; set CPU timeouts.
- Decision: Should Fix → Review ArtifactManager for regex and replace vulnerable patterns.
DoS4: Repeated /reset wipes system repeatedly.
- Mitigations: Auth + rate limiting + confirmation token.
- Decision: Should Fix → Restrict endpoint to admin scope + soft-deletion pattern.

Elevation of Privilege
EoP1: Lack of role distinction (all actions same privileges).
- Mitigations: Role-based authorization checks per endpoint; scopes in JWT; deny admin actions to non-admins.
- Decision: Should Fix → Implement role claim check in dependency.
EoP2: IAM role overly broad (wildcard permissions).
- Mitigations: Policy least privilege (Allow s3:PutObject/GetObject/DeleteObject only for bucket prefix; dynamodb:UpdateItem for specific table ARN).
- Decision: Should Fix → Review and tighten IAM policy.
EoP3: Artifact ingestion SSRF (backend fetching arbitrary internal URLs).
- Mitigations: Restrict allowed URL schemes (https only); block private RFC1918 and link-local IP ranges; DNS resolution check.
- Decision: Should Fix → Implement URL validation + IP blacklist.
EoP4: Compromised token used to perform admin operations.
- Mitigations: Short token TTL; rotation; anomaly detection.
- Decision: Won’t Fix (Phase) → Schedule for future after base auth implemented.

============================================================
6. Component Interaction Risks
============================================================
Emergent Risk: Combination of open CORS (broad browser access) + missing authentication + destructive `/reset` endpoint creates a compounded vulnerability: any website visited by a user can execute JavaScript issuing reset requests, erasing all artifacts (availability) without attribution (repudiation). This multi-component interaction (frontend policy + backend endpoint + storage orchestrator) was identified during STRIDE review rather than initial design because components seemed individually benign until combined.

============================================================
7. Cross-Component Requirement Tradeoff
============================================================
Performance vs Security: Listing artifacts currently scans the entire DynamoDB table (`scan_all`) for flexible filtering. Introducing fine-grained authorization and pagination will add conditional expressions and indexes, slightly increasing latency. Security requirements (least privilege, minimized data exposure) necessitate restricting fields and adding filters, potentially reducing performance until indexes are tuned. Plan: implement pagination + query-based access (Query by partition key) and restrict response fields to needed subset to balance both.

============================================================
8. Root Cause Analysis
============================================================
Example 1
Vulnerability & Mitigation: Authentication bypass (`verify_token` always returns True) → replace with real token/JWT validation dependency and reject unauthenticated requests.
Design Miss: Stub left from baseline to simplify early development; lack of follow-up ticket ownership allowed it to persist. Absence of threat modeling early meant spoofing risks were not prioritized. Code review focused on functionality (artifact CRUD) not auth enforcement.

Example 2
Vulnerability & Mitigation: Overly permissive CORS configuration (`allow_origins=["*"]`) enabling any origin script interaction → restrict to explicit trusted origins list loaded from environment; consider preflight strictness.
Design Miss: Convenience during local multi-port development prioritized; perceived as temporary but never revisited. No automated lint or policy gate for insecure CORS; issue surfaced only when mapping Information Disclosure threats.

============================================================
9. Planned Immediate Mitigation Implementation Order
============================================================
1. Implement JWT auth & role claims.
2. Restrict CORS origins via config.
3. Add rate limiting & request size limits.
4. Harden ingestion (URL validation, SSRF protection, timeout enforcement).
5. Enable S3 Public Access Block + DynamoDB conditional updates.
6. Structured audit logging with request IDs.
7. IAM least privilege review.
8. Artifact ID entropy verification and schema validation.

Deferred (Won’t Fix for Phase): Centralized immutable log store, nation-state AWS insider threat, advanced anomaly detection, short-lived token rotation infra.

============================================================
10. Summary
============================================================
Primary gaps addressed: missing auth, open CORS, lack of rate limits, absent audit trail, ingestion SSRF risk. The Should Fix set forms the minimum viable security posture prior to final submission. Each chosen mitigation directly reduces likelihood or impact aligned with STRIDE categorization while remaining achievable within project scope.

End of Security Analysis.




