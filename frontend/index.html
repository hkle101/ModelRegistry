<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Model Registry Frontend</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, button, textarea { margin: 5px 0; padding: 5px; width: 100%; }
    textarea { height: 80px; }
    section { border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; border-radius: 5px; }
    h2 { margin-top: 0; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 5px; }
</style>
</head>
<body>

<h1>Model Registry Frontend</h1>

<label>X-Authorization Token:</label>
<input type="text" id="authToken" placeholder="Enter X-Authorization token" />

<script>
const baseUrl = "http://localhost:8000";

function getAuthHeader() {
    const token = document.getElementById("authToken").value;
    return token ? { "X-Authorization": token } : {};
}

async function safeJson(res) {
    try { return JSON.stringify(await res.json(), null, 2); }
    catch { return await res.text(); }
}
</script>

<!-- Create Artifact -->
<section>
<h2>Create Artifact</h2>
<label>Artifact Type:</label>
<input type="text" id="createType" placeholder="model/dataset/code" />
<label>Artifact URL:</label>
<input type="text" id="createUrl" placeholder="https://github.com/user/repo" />
<button onclick="createArtifact()">Create Artifact</button>
<pre id="createResult"></pre>
</section>

<script>
async function createArtifact() {
    const type = document.getElementById("createType").value;
    const url = document.getElementById("createUrl").value;

    const res = await fetch(`${baseUrl}/artifact/${type}`, {
        method: "POST",
        headers: { "Content-Type": "application/json", ...getAuthHeader() },
        body: JSON.stringify({ url })
    });

    document.getElementById("createResult").textContent = await safeJson(res);
}
</script>

<!-- Retrieve -->
<section>
<h2>Retrieve Artifact</h2>
<input id="getId" placeholder="Artifact ID" />
<button onclick="getArtifact()">Retrieve</button>
<pre id="getResult"></pre>
</section>

<script>
async function getArtifact() {
    const id = document.getElementById("getId").value;

    const res = await fetch(`${baseUrl}/artifacts/${id}`, {
        headers: getAuthHeader()
    });

    document.getElementById("getResult").textContent = await safeJson(res);
}
</script>

<!-- Update -->
<section>
<h2>Update Artifact</h2>
<input id="updateId" placeholder="Artifact ID" />
<input id="updateUrl" placeholder="New Artifact URL" />
<button onclick="updateArtifact()">Update</button>
<pre id="updateResult"></pre>
</section>

<script>
async function updateArtifact() {
    const id = document.getElementById("updateId").value;
    const url = document.getElementById("updateUrl").value;

    const res = await fetch(`${baseUrl}/artifacts/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json", ...getAuthHeader() },
        body: JSON.stringify({ url })
    });

    document.getElementById("updateResult").textContent = await safeJson(res);
}
</script>

<!-- Delete -->
<section>
<h2>Delete Artifact</h2>
<input id="deleteId" placeholder="Artifact ID" />
<button onclick="deleteArtifact()">Delete</button>
<pre id="deleteResult"></pre>
</section>

<script>
async function deleteArtifact() {
    const id = document.getElementById("deleteId").value;

    const res = await fetch(`${baseUrl}/artifacts/${id}`, {
        method: "DELETE",
        headers: getAuthHeader()
    });

    document.getElementById("deleteResult").textContent = await safeJson(res);
}
</script>

<!-- List -->
<section>
<h2>List All Artifacts</h2>
<button onclick="listArtifacts()">List</button>
<pre id="listResult"></pre>
</section>

<script>
async function listArtifacts() {
    const query = [{ name: ".*" }]; // your backend expects List[ArtifactQuery]

    const res = await fetch(`${baseUrl}/artifacts`, {
        method: "POST",
        headers: { "Content-Type": "application/json", ...getAuthHeader() },
        body: JSON.stringify(query)
    });

    document.getElementById("listResult").textContent = await safeJson(res);
}
</script>

<!-- Reset -->
<section>
<h2>Reset Registry</h2>
<button onclick="resetRegistry()">Reset Registry</button>
<pre id="resetResult"></pre>
</section>

<script>
async function resetRegistry() {
    const res = await fetch(`${baseUrl}/reset`, {
        method: "DELETE",
        headers: getAuthHeader()
    });

    document.getElementById("resetResult").textContent = await safeJson(res);
}
</script>

<!-- Health -->
<section>
<h2>Health Check</h2>
<button onclick="healthCheck()">Check Health</button>
<pre id="healthResult"></pre>
</section>

<script>
async function healthCheck() {
    const res = await fetch(`${baseUrl}/health`);
    document.getElementById("healthResult").textContent = await safeJson(res);
}
</script>

</body>
</html>
